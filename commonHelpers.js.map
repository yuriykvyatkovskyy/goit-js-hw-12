{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('input');\nconst galleryBox = document.querySelector('.gallery-box');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loaderBottom = document.querySelector('.loader-bottom');\nconst loadingBtn = document.querySelector('.loading-btn');\n\nlet page = 1;\nlet q = '';\nlet perPage = 40;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    nav: true,\n    captionDelay: 250,\n    captionsData: 'alt',\n    close: true,\n    enableKeyboard: true,\n    docClose: true,\n});\n\n// Пошук за формою\nform.addEventListener('submit', onSubmit);\nloadingBtn.addEventListener('click', loadMore);\n\nasync function onSubmit(event) {\n  event.preventDefault();\n  page = 1;\n  loader.style.display = 'none';\n  q = event.target.elements.search.value.trim();\n\n  if (!q) {\n    gallery.innerHTML = '';\n    loadingBtn.style.display = 'none';\n    return iziToast.info({\n      position: 'topRight',\n      message: 'Error enter any symbols',\n    });\n  }\n  try {\n    loader.style.display = 'block';\n    const {\n      data: { hits, total },\n    } = await searchImg(q, page);\n\n    if (hits.length > 0) {\n      loader.style.display = 'none';\n      gallery.innerHTML = renderImg(hits);\n      lightbox.refresh();\n      iziToast.success({\n        position: 'topRight',\n        message: `We found ${total} photos`,\n      });\n      loadingBtn.style.display = 'block';\n    } else {\n      gallery.innerHTML = '';\n      iziToast.error({\n        position: 'topRight',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n\n    if (total <= perPage) {\n      loadingBtn.style.display = 'none';\n    }\n  } catch (error) {\n    console.log('Error');\n  } finally {\n    loader.style.display = 'none';\n    form.reset();\n  }\n}\n\n// Опції для пошуку\nfunction searchImg(q, page) {\n  axios.defaults.baseURL = 'https://pixabay.com/api/';\n\n  return axios.get('', {\n    params: {\n      key: '41752354-d1ac8bee07efd7a3da621dba9',\n      q,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: 40,\n    },\n  });\n}\n\n// Галерея\nfunction renderImg(hits = []) {\n  return hits.reduce((html, hit) => {\n    return (\n      html +\n      `<li class=\"gallery-item\">\n        <a href=${hit.largeImageURL}>\n          <img class=\"gallery-img\" src =${hit.webformatURL} alt=${hit.tags}/>\n        </a>\n        <div class=\"gallery-text-box\">\n          <p>Likes: <span class=\"text-value\">${hit.likes}</span></p>\n          <p>views: <span class=\"text-value\">${hit.views}</span></p>\n          <p>comments: <span class=\"text-value\">${hit.comments}</span></p>\n          <p>downloads: <span class=\"text-value\">${hit.downloads}</span></p>\n      </div>\n      </li>`\n    );\n  }, '');\n}\n\n// Кнопка 'Load more' та пошук за нею\nasync function loadMore(event) {\n  event.preventDefault();\n  loaderBottom.style.display = 'block';\n  loadingBtn.style.display = 'none';\n  try {\n    page += 1;\n\n    const {\n      data: { hits, totalHits },\n    } = await searchImg(q, page);\n    const totalPage = Math.ceil(totalHits / perPage);\n\n    if (page < totalPage) {\n      loaderBottom.style.display = 'none';\n      loadingBtn.style.display = 'block';\n        gallery.insertAdjacentHTML('beforeend', renderImg(hits));\n        lightbox.refresh();\n    } else {\n      loaderBottom.style.display = 'none';\n      loadingBtn.style.display = 'none';\n\n      return iziToast.info({\n        position: 'topRight',\n        message: `We're sorry, but you've reached the end of search results.`,\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  } \n\n  const listItem = document.querySelector('.gallery-item:first-child');\n  const itemHeight = listItem.getBoundingClientRect().height;\n  console.log(itemHeight);\n  console.log(listItem);\n  window.scrollBy({\n    top: 2 * itemHeight,\n    behavior: 'smooth',\n  });\n}"],"names":["form","gallery","loader","loaderBottom","loadingBtn","page","q","perPage","lightbox","SimpleLightbox","onSubmit","loadMore","event","iziToast","hits","total","searchImg","renderImg","axios","html","hit","totalHits","totalPage","error","listItem","itemHeight"],"mappings":"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"}